<a name="br1"></a> 

2023 秋光电学院小学期实验报告

实验名称：计算全息

指导老师

姓名

学号：

专业

一、全息理论

1\. 波前计算

波前计算。计算物光波前在全息图平面的光场分布是计算全息的核心问题，它直接关系

到算法实现所需要的时间以及最后的图像重建质量。计算时，首先要对物体以及全息图平面

进行离散化，通常需要对两者进行分别采样。

2\. 波前编码

记录物光波的振幅信息以及相位信息，这也是全息术与普通成像的根本区别。干涉法是

标准的相位编码方法。

假设在全息图的记录平面上，物光波和参考光波的复振幅分别为

U(x, y)= U(x, y)e <sup>j</sup> ( , )

j

x y

0

R(x, y)= R(x, y)e <sup>j</sup> ( , )

j

x y

r

于是参考波与物光波干涉的强度分布为

I(x, y) U(x, y) R(x, y)

\=

\+

2

\=

\=

U(x, y)

U(x, y)

2

\+

\+

R(x, y)<sup>2 +</sup>U(x, y)R<sup>\*</sup>(x, y)<sup>+</sup>U<sup>\*</sup>(x, y)R(x, y)

2

R(x, y) 2U(x, y) R(x, y)cos[ (x, y)

2

\+

j

0

-j

(x, y)]

r

可以看出该式的前两项只包含了物光波以及参考光波的强度信息，第三项则包含了物光

波与参考光波之间的相对相位关系。因此，上式表示的干涉图样包含了物光波的振幅和相位

信息。

在数字全息的记录过程中，由于是使用 CCD 来记录干涉条纹，相当于对干 涉条纹进行

了离散化处理。数学上相当于被采样离散成二维图像 I(x, y)<sub>，即数字全息图，存储于计算</sub>

<sub>机中，</sub> (x, y)<sub>代表离散采样点。</sub>

此外，为了在干涉过程中能记录下被测物的全部信息并完全重建得到物体的 原始像，

要求记录面上光波的空间频率和 CCD 的空间采样频率满足采样定理， 即 CCD 的采样频率

必须是全息面上物光波最大空间频率的两倍以上

3\. 波前重建

当物光波的振幅和相位信息通过编码方式记录到全息图中后，就可以通过光学或数字的

方式对物光波进行重建。物光波的重建是以全息图对重建光波的衍射为基础的。全息图重建

的过程就是利用重建光波来照射全息图，经过衍射后就能获得物光波的强度和相位信息。

用一束相干的重建光波

B(x, y)= B(x, y)e <sup>j</sup> ( , )

j

x y

b

照射全息面，相当于对模拟的参考光波进行离散采样，从而得到的光场分布为

u(x, y)= B(x, y)I(x, y)

= u + u + u + u

4

1

2

3



<a name="br2"></a> 

当 B(x, y)<sub>与</sub> R(x, y)<sub>共轭时，有</sub>

u + u + u + u

1

2

3

4

<sub>= b</sub>[<sub>U</sub>(x, y) R (x, y)+ R(x, y) R (x, y)+U(x, y)R (x, y)+U (x, y)R(x, y) ]

2

2

2

2

\*

\*

\*

\*

u ，u 与重建光波具有相同的相位，它们以重建光波的方向进行传播，即得到的是零

1

2

级衍射光波；u 为+1 级衍射光波，其包含了原始物光波振幅信息和相位信息；u 为−1 级衍

3

4

射光波，其包含了记录物体的共轭信息，以及一些附加相位信息，因此这一项成为畸变了的

共轭像。

4\. 计算方法

(1) 菲涅尔衍射积分

设O(x , y ),U(x, y)<sub>分别为物平面及观测平面的光波复振幅，</sub>d 为两平面间的距离．菲

0

0

涅耳衍射积分的傅里叶变换形式可以写为

(x-x )<sup>2</sup> +(y-y )<sup>2</sup>

e

jkd

jk

0

0

U(x, y)

\=

òò

O(x , y )e

dx<sub>0</sub>dy<sub>0</sub>

2

d

jld

0

0

化简整理为

jkd +

<sup>2</sup> +

<sup>jk</sup> (<sub>x</sub> <sup>y</sup>2 <sup>)</sup>

jk

2d

(

)

2

p

e

2

d

2

0

2

0

(

0

0

)

x

\+

y

\-

j l x x y y

\+

U(x, y)

\=

òò

O(x , y )e

e

dx<sub>0</sub>dy<sub>0</sub>

L

d

l

0

0

j d

令物平面取样宽度为 L ，取样数为 N×N，即取样间距 x

D

= D

y<sub>0</sub>

\=

<sup>0</sup> ，p,q,m,n 为采

0

0

N

样点坐标（取-N/2,−N/2+1,…, N/2−1）。则可用快速傅里叶变换 FFT 表示为

jkd + [(pDx)<sup>2</sup> +(qDy)<sup>2</sup> ]

jk

é

<sup>jk</sup> [(

n y

) ]ù

e

2d

0

<sup>)2</sup> +(

0

2

mDx

D

U(pDx,qDy)=

FFT O(mDx ,nDy )e

ê

2d

ú

jld

0

0

ë

û

(2) 角谱理论

当单色相干光场照明衍射屏时,其后距离为 d 的观察屏上的光场分布由菲涅尔衍射积分

公式给出

(x-x )<sup>2</sup> +(y-y )<sup>2</sup>

e

jkd

jk

0

0

U(x, y)

\=

òò

O(x , y )e

dx<sub>0</sub>dy<sub>0</sub>

2

d

jld

0

0

将菲涅尔衍射看成一个光学系统,衍射屏后表面作为系统的输入面,观察屏作为系统的输

出面,于是菲涅尔衍射可看成一个线性空间平移不变系统,其脉冲响应函数为

jk

<sup>(</sup>x<sup>2</sup>

)

1

jld

y<sup>2</sup>

\+

h(x, y)

\=

e

2d

传递函数为

H(e，h)= FFT[h(x, y)]

以 L , L 为采样宽度， p,q 为采样点坐标（取-N/2,−N/2+1,…, N/2−1）。离散化采样可

x

y

得



<a name="br3"></a> 

<sup>é</sup>(

pDxL<sup>-</sup><sub>x</sub><sup>1</sup> + qDyL<sup>-1</sup>

)

2

(

)<sup>2 ù</sup>

H(pDx,qDy)= e<sup>- jpld</sup>

ê

y

ú

ë

û

衍射屏后表面上物光场的角谱与观察屏上衍射光场的角谱分别为

A(e，h)= FFT[U(x, y)], A<sub>0</sub> (e，h)= FFT[O(x, y)]

由于衍射屏上光场等于物光场与脉冲响应函数卷积，故有

U(x, y)= iFFT[A<sub>0</sub> (e,h)H(e,h)]

（3）透镜傅里叶变换性质

对于一个计算全息的重建光路，在 SLM 后要放上一个正透镜，相当于对入射光场进行

了一次傅里叶变换。假定一个振幅为 A 的单色平面波透过一个透过率为t 的透明片，则紧贴

透镜后方的复振幅分布为

\- j

<sup>k (x2</sup> + <sup>y2 )</sup>

U<sub>l</sub> (x, y)= Ate

2 f

利用菲涅尔积分，令 z = f ，则在焦平面处的复振幅分布为

<sup>k (u</sup>2 <sup>+v</sup>2 <sup>)</sup>

2 f

<sub>j</sub> <sup>k</sup> (<sub>u</sub> <sup>+v</sup>2 <sup>)</sup>

2

j

2p

é

2p

<sub>)</sub>ù

xu yv

e

òò<sub>Ul (x, y)e</sub>- l (

xu

\+

<sup>yv</sup>)

e

2 f

\- l (

\+

U <sub>f</sub> (u,v)=

dxdy =

FFT êU (x, y)e

f

f

ú

jlf

j f

l

l

êë

úû

正比于孔径以内的入射光场。

二、基础实验：彩虹全息图

1\. 全息图制作步骤

第一步：用参考光 R 以普通菲涅耳全息图方法记录原始物体O 一张全息图 H ，这张全

1

息图常被称为主全息图，如图 1 所示。

1

图 2

图 1

第二步：用第一步所使用参考光的共轭光即

R<sup>\*</sup> 照明再现 H ，同时 ，在 H 前面加一个

1

1

1

狭缝，这样形成的像是通过狭缝形成的赝像．若以此实像作为新的物光再用另一束参考光 R<sub>2</sub>

与其干涉而制作成一张菲涅耳全息图 H<sub>2</sub> ，这就做成了一张彩虹全息图，如图 2 所示。

第三步：若以 R<sub>2</sub> 的共轭光

R<sub>2</sub><sup>\*</sup> 作为照明光，将再现出狭缝的实像和所记录的物体赝像 O<sup>\*</sup>

的赝像，也就是物体的原始像。若观察者在狭缝的实像处向 H<sub>2</sub> 方向观看，他将看到物体的

单色三维像。由于受到狭缝的限制，在竖直方向失去了纵向的视差，而横向视差则完全保留，

所以观察者仍有强烈的景深感觉。



<a name="br4"></a> 

图 3

如果以白色点光源照明再现 H<sub>2</sub> ，则将再现出一系列按自上而下波长逐渐减小的顺序，

即按红、橙、黄、绿、青、蓝、紫彩虹颜色顺序排列的连续的狭缝实像，形成一个彩虹色窗

口。于是，通过这个窗口便可以看到按彩虹色顺序排列的不同颜色的、有横向视差的、彩虹

色的三维像，如图 3。

2\.基础实验进行二步彩虹全息图的仿真模拟。

（1）振幅型全息图

振幅型计算全息图是将物光波信息转化为全息图的干涉条纹图形记录在显示媒介上。传

统的振幅型全息图是将干涉条纹的强度记录在介质上，从而改变全息平板的透过率。

第一步制作母全息图 H<sub>1 。</sub>首先采用菲涅尔衍射积分法，得到物光在全息平板位置处的

复光场，并干涉以斜入射的参考光球面波 R<sub>1</sub> ，最后取强度得到一块振幅型全息图。

根据菲涅尔衍射积分可得，在全息平面上的物光场与参考光场分别为

(x-x )<sup>2</sup> +(y-y )<sup>2</sup>

e

jkd

jk

0

0

U (x , y )

\=

òò

O(x , y )e

dx<sub>0</sub>dy<sub>0</sub>

2d

1

1

1

l

0

0

j d

jkb<sub>2</sub> jkby <sub>jk</sub> (<sub>x + y</sub> )

2

2

R(x , y )= r e

e

e

2z<sub>0</sub>

z<sub>0</sub>

2z<sub>0</sub>

1

1

0

z

其中参考光为来自全息平板后方 处，在竖直方向是偏离全息图中心距离 的球面波

b

0

(0，b,-z )

H

（即光源在

）。干涉后的全息图

光场为

0

1

u + u + u + u

4

1

2

3

<sub>= b</sub>[<sub>U</sub> (x , y ) + R(x , y ) +U (x , y )R (x , y )+U (x , y )R(x , y )]

2

2

\*

1

\*

1

1

1

1

1

1

1

1

1

1

1

1

1

1

<sup>jk</sup> (<sub>x y</sub> )

<sup>2</sup> +

u ，u

3

2

式中，

两项消去了相位因子

。

1

1

e

2z

0

4

图 4

图 5

图 4 为原始图像，图 5 为母全息图 H<sub>1 。</sub>



<a name="br5"></a> 

H

H

1

第二步制作彩虹全息图

全息图。这里采用菲涅尔衍射积分来计算衍射后产生的再现像。由于形成的是离轴全息光路。

则对干涉项<sup>u</sup>

。将

得到取狭缝，相当于原全息图破裂，但仍能重建出

2

H

进行计算可得，在全息平面

得到的共轭像光场为

4

2

e

jkz<sub>c</sub>

\-

<sup>jk</sup> (<sub>x12 + y</sub> ) <sup>jk</sup> [(x x )<sup>2</sup> +<sup>(y</sup> y ) ]

2

\-

\-

2

òò<sub>u3e</sub>

1

1

2

1

2

2z

e

2z

dxdy

c

c

l

j z<sub>c</sub>

jk

(

)

x

1 ç

æ

<sup>z</sup>c

<sup>z</sup>0

ö

ù

<sup>1</sup> ú

jk(z<sub>c</sub> z )

\-

é

jk

ù

<sup>z</sup>0<sup>e</sup>

x<sup>2</sup> y<sup>2</sup>

\+

æ

è

<sup>2</sup> +

<sup>2</sup>z ç x<sup>'</sup> y<sup>'</sup>

2

0

ö

ø

\-

j2

p é

ê

<sup>2</sup> x

c

\+

\-

b÷ y

0

(

)

e

\-

l

÷

1

1

2

2

òò

FFT O<sup>\*</sup> x<sub>0</sub><sup>'</sup>, y<sub>0</sub><sup>'</sup>

0

0

ê

l

z

l

z è

\=

r<sub>0</sub>

e

2z<sub>c</sub>

e

ë

ø

<sup>û</sup>dx<sub>1</sub>dy<sub>1</sub>

ê

2

ú

c

z<sub>c</sub>

ë

û

<sup>x</sup>0

lz<sub>0</sub>

y

0

lz<sub>0</sub>

z

式中 为全息图

H

x

'

0

\=

, y<sup>'</sup>

\=

。由此可表明<sup>u</sup>

H

坐标，

在

平面再现的为再

c

2

0

4

2

现平面上的共轭实像。同理<sup>u</sup>

可获得原始实像。

3

此时得到的为零级像，原始像以及共轭像（孪生像）。由于使用参考光 R<sub>1</sub> 斜入射，因

此u<sub>3</sub> （原始像）在原有基础上增加了附加相位，在成像平面表现为空移，此时共轭像与原

始像分离。在成像处用平板记录光场，同时用参考光 R<sub>2</sub> 干涉得到 H

<sub>2</sub> 。

图 6

图 7

图 8

图 6 为用狭缝限制后的母全息图（彩色域）。图 7 为 H<sub>1</sub> 重建后的得到的赝像（灰度域），

可观察到原始像与共轭像分离。图 8 为赝像经过参考光干涉后得到的彩虹全息图 H<sub>2</sub> （彩色

域）。

H

第三步，重建图像。对全息图

进行菲涅尔衍射积分计算，得到原始图通过狭缝的赝

2

像的赝像，此赝像受到狭缝的限制。

图 9

图 10

图8为重建的狭缝像及其孪生像，图9为经过均值滤波并转换到彩色域的狭缝像及其孪生像。

（2）相位型全息图

相位型全息图只将光波的相位信息编码到全息图中，对入射光波振幅的调制系数在全息

图的各个位置均相同，物光波的相位信息不借助参考光干涉，由相位全息图进行直接编码。

相位型全息图的编码基于一个假设：全息图平面的相位分布携带了绝大部分信息，而振幅信



<a name="br6"></a> 

息可以忽略。相位型全息图通过改变入射光波的光程来调制相位，从而再现物光波，具有非

常高的衍射效率，重建时只在光轴方向有单个重建像且不受共轭像的干扰。

第一步，制作母全息图 H<sub>1</sub> 。利用角谱衍射理论，计算物光到达全息平板时的光场。对

此光场取相位，得到母全息图。

图 11

图 12

图 11 为原始物体，图 12 为母全息图 H<sub>1</sub> 。

第二步，在母全息图 H<sub>1</sub> 前覆盖狭缝，相当于全息图破裂。由于相位全息图不采用

参考光进行干涉，因此重建时无法在光场中产生<sup>O\*</sup> 项，即对 H<sub>1</sub> 重建得到的是原始像，

而非赝像，与实际的彩虹全息图不符。因此，在使用角谱理论仿真计算前，应当先对 H<sub>1</sub>

取共轭，此后再利用角谱理论进行计算，从而得到 H<sub>2</sub> 。利用傅里叶变换共轭性质，易

得

U (x , y )= <sub>iFFT</sub>{<sub>FFT</sub>[<sub>U</sub> (x , y )]<sub>h</sub> }

\*

2

2

2

1

1

1

2

<sub>= iFFT</sub>{<sub>FFT</sub>[<sub>iFFT</sub>(FFT(O (x , y ))h ) ]<sub>h</sub> }

\*

0

0

0

1

2

= <sub>iFFT</sub>{<sub>FFT</sub>[<sub>FFT</sub>(<sub>iFFT</sub>(<sub>O</sub> (x , y ))<sub>h</sub> )]<sub>h</sub> }

\*

0

\*

1

0

0

2

= CO<sub>0</sub>

\*

上式子中U ，U ，U 分别表示物光场，母全息图 H 光场，全息图 H 光场。h ，

0

1

2

1

2

1

h<sub>1</sub> 分别表示对应传递函数，C 为某复常数。

图 15

图 14

图 13

图 13 为加上狭缝的全息图 H ，图 14 为全息图 H 灰度域，图 15 为全息图 H 彩

1

2

2

色域。

第三步，重建图像。利用角谱理论，计算全息图 H<sub>2</sub> 在成像平面上的衍射场分布，

得到原始像。由于此时所成的像为赝像的赝像，所以同样需要对全息图进行取共轭的操

作，由共轭性易得



<a name="br7"></a> 

U (x , y )= <sub>iFFT</sub>{<sub>FFT</sub>[<sub>U</sub> (x , y )]<sub>h</sub> }

\*

3

3

3

2

2

2

3

= CO<sub>0</sub>

式子中 h<sub>3</sub> 分别表示对应传递函数，C 为某复常数。

图 16

图 17

图 16 为灰度域下重建结果，可见狭缝像。图 17 为不同波长的光学重建结果的叠加。

三、创新实验

1\.相关理论

（1）GS 算法原理

相息图的计算问题由于只对观察平面衍射光场的强度信息提出了要求，无法求出其解析

解，因此需要将其转化为数值优化问题，从而利用优化算法寻求在某种范数下的最优解。

本次创新实验所用的 GS 算法就是一种迭代优化算法。第 n 次迭代的实现过程可以通过

以下四步来进行描述。

第一步，对第 n-1 次迭代的结果进行 Fourier 变换：

G (u,v)= F[g (x, y)]

n

n-1

第二步，保持第一步所得复数矩阵的相位不变，振幅归一化：

<sup>G</sup>n <sup>(u,v)</sup>

G

'

n

(u,v)=

G<sub>n</sub> (u,v)

第三步，归一化频域分布进行逆 Fourier 变换：

g

'

n

(x, y)= <sub>iFFT</sub>[<sub>Gni</sub> (u,v)]

第四步，保留 Fourier 变换后的相位信息，将振幅分布更换为目标图像的振幅 g<sub>0</sub> (x, y)<sub>，</sub>

并将所得结果作为第 n+1 次迭代的输入：

g

g

'

n

'

n

(x, y)

(x, y)

g (x, y)= g (x, y)

n

0

经过多次迭代后，得到再现像，并由此获得振幅型全息图。

（2）光路

利用激光器经过目镜与针孔等器件，获得质量较高的平行光后，振幅型 SLM 将对平行

光进行振幅调制。根据透镜的相位调制函数

\- j

<sup>k (x2</sup> + <sup>y2 )</sup>

U<sub>l</sub> (x, y)= Ate

2 f

<sup>k (u</sup>2 <sup>+v</sup>2 <sup>)</sup>

2 f

j

2p

e

òò<sub>U x, y e</sub> lf (<sup>xu+ yv)</sup>dxdy

\-

U u,v =

(

)

(

)

f

jlf

l

以及菲涅尔衍射积分



<a name="br8"></a> 

jkd +

<sup>2</sup> +

<sup>jk</sup> (<sub>x</sub> <sup>y</sup>2 <sup>)</sup>

jk

2d

(

)

2

p

e

2

d

2

0

2

0

(

0

0

)

x

\+

y

\-

j l x x y y

\+

U(x, y)

\=

òò

O(x , y )e

e

dx<sub>0</sub>dy<sub>0</sub>

d

l

0

0

j d

可得，傅里叶透镜造成的傅里叶变换可以起到菲涅尔衍射的作用。

图 18

图 19

图 18 为实际光路，图 19 为光路图

(3) 分离孪生像

对振幅型全息图，分离孪生采用离轴全息图的方法。

u + u + u + u

4

1

2

3

<sub>= b</sub>[<sub>U</sub> (x , y ) + R(x , y ) +U (x , y )R (x , y )+U (x , y )R(x , y )]

2

2

\*

1

\*

1

1

1

1

1

1

1

1

1

1

1

1

1

1

在全息平面上用参考光与物光进行干涉，可得到干涉项，即式中的<sup>u ，u</sup>

两项。分别编

3

4

码了原始像与共轭像的信息。

参考光为平面波时，可表示为

sinq

\- j2p

y

R =r<sub>0</sub>e

l

则经过透镜的傅里叶变换以后，原始像与共轭像可表示为

jkd + (<sub>x</sub><sup>2</sup> <sub>+ y</sub><sup>2</sup>

jk

)

sinq

l

jk

(

)

2p

e

e

2d

<sup>y</sup>0

x<sup>2</sup> y<sup>2</sup>

1

1

(

1

1

)

j2

p

\+

\-

j

x x y y

\+

òò

U (x , y )r e

U<sub>2</sub> =

e

e

l

dx<sub>1</sub>dy<sub>1</sub>

2d

d

l

1

1

1

0

j d

jkd + (<sub>x</sub><sup>2</sup> <sub>+ y</sub><sup>2</sup>

jk

)

é

sinq

<sup>jk</sup> (

x<sup>2</sup> + y<sup>2</sup>

)ù

2d

p

j2

<sup>y</sup>0

\=

FFT U (x , y )r e

l

e

1

1

ê

2d

ú

jld

1

1

1

0

ë

û

jkd + (<sub>x</sub><sup>2</sup> <sub>+ y</sub><sup>2</sup>

jk

)

sinq

l

jk

(

)

2p

e

2d

<sup>y</sup>0

x<sup>2</sup> y<sup>2</sup>

1

1

(

1

1

)

\-

j2

p

\+

\-

j

x x y y

\+

U =

\*

òò

U (x , y )r e

\*

e

e

l

dx<sub>1</sub>dy<sub>1</sub>

2d

d

2

l

1

1

1

0

j d

jkd + (<sub>x</sub><sup>2</sup> <sub>+ y</sub><sup>2</sup>

jk

)

é

sinq

l

<sup>jk</sup> (

<sup>2</sup> +

)ù

e

2d

<sup>y</sup>0

1

2

\-

j

2p

x

1

y

\=

FFT U

\*

(x , y )r e

e

ê

2d

ú

1

jld

1

1

0

ë

û

sinq

l

U<sub>2</sub>，U<sup>\*</sup> 只在傅里叶变换内有相位因子 <sup>- j2p</sup>

<sup>y</sup> 的差异。经过傅

可见，原始像共轭像

e

2

里叶变换以后，频移变为空移，从而使得孪生像分离。

2\. 仿真结果与光学验证结果



<a name="br9"></a> 

图 20

图 21

图 22

图 23

图 20 为原图，图 21 为计算机仿真结果，图 22 为振幅全息图，23 为光学仿真结果。

四、思考题

1\. 振幅型和相位型的优势：

振幅型：振幅型空间光调制器具有较高的刷新频率，振幅型全息图也因此具有较高的时间带

宽，并允许在光学重建中牺牲部分时间带宽从而实现扩展视场角、抑制散斑、引入运动视差

等效果。但由于振幅型全息图在重建时参考光照明的全息图为实函数，由全息图衍射生成的

图像上方会出现未聚焦的共轭像引起的噪声。

相位型：相位型空间光调制器具有相对较低的刷新速率，限制了相位型全息图的动态效果与

功能扩展。但相位型全息图不受共轭像噪声影响，重建光能利用率高，因而也成为全息显示

不可忽视的技术方向。由于全息图振幅项均匀化，自然物体的相位型全息图低频成分受到抑

制，重建时的图像损失背景成分。

2\.SLM 结构可能出现问题：衍射效率低，抽样定理造成噪声

3\.像素间隔对图像影响：像素间隔越小，采样率越高，重建效果越好。像素间隔越大，采样

率越低，重建效果越差。

4\.准直扩束系统中针孔作用有哪些：将激光变为点光源，提高光源质量

